第一个样例：
4 时序网络节点排名方法

4. 1 时序网络

与传统网络相比，随着时间的推移，时序网络的拓扑结构会相应地发生演变。如

图4.1，在 t0 时刻该网络中只有三个节点，而在 t1、t2 两个时间点上，该网络分别新增

了指向 A 的 D 节点和指向 D 的 E、F 节点。

在时序网络中，每个节点间不仅要有基本的链接关系，在节点和边上还要有与之相

对应的时序特性。本文通过数据中各个节点的基本链接关系，构建了对应的网络拓扑结

构，作为时序网络模型的基本框架。然后根据每个节点的各自时序属性以及边的左右两

侧节点的时序特征为每个边赋予对应的时序特性，进而创建出一个边和节点都具有相应

时序特性的时序网络。基于这种修改，在后续的排序算法中，每个节点的对应转移概率

将不会是等价数值，而会因当前节点的时序特性不同而发生相应的变化，这在无形中增

加了本文实现这个方法的难度。

图 4.1 时序网络示例图

4. 2 时序递减方法

在本文的时序网络节点排名方法中，有几类时序递减方法可供用户选择。鉴于这几

类方法的基本逻辑大致相似，在这里就以指数函数作为当前的时序递减方法，阐释关于

本文的时序递减方法的基本逻辑。

在该方法中，网络中的每个节点的时序特性会随着时间的推移而发生变化。由于本

文设计该方法目的是让时序网络中的新节点在网络拓扑结构中能受到更多的关注，所以

本文的时序递减方法的设计思路是随着时间由近及远，每个节点所对应的时序特性逐渐

9

浙江财经大学本科生毕业论文（设计）

减弱，也即节点在时序网络中的重要因素逐渐降低，公式如下：

g(t) =







if t ≥ ti

: 1

if t < ti

: a

t−ti

(4-1)

在公式 g(t) 中，t 表示该节点或边的时序特性，而 ti 则表示当前时序网络排序方法

的最近时间点。公式中 a 的值由用户自行调整定义，便于用户在探索时序网络排序演变

过程中可自由调整节点及边的时序特性消弱趋势，更好的分析当前的时序网络演变情

况。

在本文中，其余几类可供用户选择的时序递减方法与上述方法运行逻辑基本相同，

用户可根据当前时序网络对节点的时序特性消弱需求自行选择合适的时序递减方法。同

时在前端的控制视图中，用户也可自行查看当前递减方法的消弱趋势，便于用户自由使

用及探索出合适的时序递减方法。

4. 3 时序网络节点排名方法

在本文的项目中，系统的时序网络节点重要性排名算法不仅需要为边和节点分配相

应的时序特性，还需要借助现有的 PageRank 方法实现时序转移概率的更迭计算，从而

得到本文系统所需的时序网络排序结果。在该模型中，其基础排序方法的工作原理为随

机地跳转至某些任意节点或是递寻地依照现有的链接来遍寻整个时序网络。在原有的排

序方法中，上述两类事件发生的几率是不同的。随机跳转某些任意节点是在当前节点无

未探索链接的时候执行的，其发生几率较为固定。而对于依照现有链接递寻探索，则是

需要依照未探寻链接及其在该节点上的时序转移特性强弱来判断的。在以下的公式中，

本文将会介绍节点 I 的 PageRank 值 P R(i)：

P R(i) = ∑

(i,j)∈E

(1 − ε)

P R(j)

outdegree(j)

+ ε ·

1

m

(4-2)

上述公式是该模型的基本排序公式，其含义可阐述为在时序网络中的每个节点的时

序特性强弱程度都大抵相同，也即对节点以及边的时序特征进行等值处理，然后在排序

方法的随机步行过程中，其在每个节点上对每个链接的跳转几率都是近乎等同的。公式

中后半部分也体现了上述观点，在网络中每个节点的时序特性强弱程度都是等价的，也

即 1

m。

当前的工作已经阐述了本毕设基本排序模型的工作流程及原理，但是由于本文需要

10

浙江财经大学本科生毕业论文（设计）

进行时序网络节点重要性排名，故当前的排序方法还需要综合考虑当前时序网络中各个

边和节点的时序特征。鉴于之前本文在构建时序网络的过程中为边和节点都赋予了对

应的时序特性，在网络排序过程中，随机步行在选择节点中各个链接的情况会受到每个

链接自身在该节点上的时序特性强弱的影响，链接的时效性越强，步行者便越容易跳转

到该链接所对应的另一侧节点上。同时，每个节点的时序特征强弱也会影响网络排序过

程中模型对跳转节点的选择。时序特征越强的节点，也就是在时序网络中越新加入的节

点，在模型的选择过程中往往更具有优势，因此也更能实现本文对新节点能够获得更多

关注的期待。下面是本文依托该思想对当前的基础方法进行的改进公式，节点 I 的改进

排序得分 RankValue 值 RV (i) 为：

RV (i) = ∑

(i,j)∈E

(1 − ε) · t(i, j) · RV (j) + ε · s(i) (4-3)

在如上的改进中，本文先是对每个节点的时序概率进行的更改，从先前的等值转变

为了当前的依照节点时序特性强弱 s(i) 进行分配。在原有的基础排序算法跳转的基础

上，引入了 t(i, j) 表示当前模型在链接上随机跳转的时序几率强弱，使得该方法的游走

递寻过程更能收到此时节点及边的时序特征的影响，使得到的排序结果更具时序性。

图 4.2 示例图

为了更好地说明上述过程，本文举例如上图4.2所示。先假定 A 节点是该时序网络

中的一个老节点，作为其中较早加入该网络，且在网络中具有较大影响力的节点，A 节

点被众多节点所指向。当系统使用基础的网络排序方法时，由于其本身为静态方法的特

点，故在排序过程中 A 节点在网络中的排名会非常高。但是该网络作为时序网络，其

网络自身的结构往往会随时间的推移而产生一定的演变。当时序网络推移到某一时间点

时，网络中加入了一个新节点，即 B 节点。此时，B 节点由于其新加入该网络，只有

指向先前节点的链接，而没有时间吸引指向自己的边。如果按照基础的排序方法对该时

11

浙江财经大学本科生毕业论文（设计）

序网络进行排序，那么排序结果将对 B 节点而言十分不友好。所以在本文改进的时序

网络方法中，系统会先将每个节点依照其加入网络的时序为其赋予时序特性，而后对于

网络的边，则会根据链接两侧的节点当前的时序特征进行相应的时序转移特性的分配。

因此在时序网络节点重要性排名的过程中，即使是新加入的 B 节点，也会因为其节点

的时序特性较强而得到较为靠前的排序。而对于 A 节点这种先前加入的节点，则会因

为其时序特性较弱而被削减排序的分数，排序也因此被滞后。通过上述对排序算法的改

进，本文将会得到一个更具有时序考量的网络节点排序方法，这对诸如引文网络、城市

交通网络等时序网络的排序问题的解决有着重要的意义。



第二个样例：
4异常检测模型
在本节中，会详细介绍LSTM-AE的工作及其在光伏阵列分析过程中的应用。
4.1 LSTM-AE模型
为了解决在具有复杂结构特征的PV序列数据(R1)中获得异常事件标签的问题，我们利用LSTM-AE模型来实现PV序列数据中的异常事件检测。该模型的第一部分是自动编码器(AE)。AE是一个层次模型，其目标是使重建数据X'无限接近原始数据X。两者之间的误差越小，AE的训练效果就越好。AE由编码器和解码器两部分组成。
编码器将M维向量X={X₁,X₂,…,Xm}作为输入，并将其抽象为N维潜在特征向量H={H₁,H₂,…,Hn},M通常大于N。然后，解码器将N维潜在特性向量映射到接近输入向量的预期输出向量X'={X1,X2,…,Xm}。
Encoder:Xm→Hn(4-1)Decoder:Hn→Xm
在编码部分，编码器的输出可以表示为方程(4-2)。H₁是从X到H的对应连接权重矩阵，μ1∈Rn*m,β1是偏置向量，α1是激活函数。
(4-2)H=α1(μ₁X+β₁)
在解码部分中，解码器的输出可以表示为方程(4-3)。是从H到X'的对应连接权重矩阵，μ2∈Rm*,β2是偏置向量，α2是激活函数。
(4-3)X'=α2(μ₂H+β₂)
最后，我将把平均绝对误差(MAE)最小化，以确保输入向量X与输出向量尽可能相似。我们将此值作为检测的默认阈值。因此，AE的目标函数可以描述为：
aineCX,x)-六x-x!(4-4)
9该模型的第二部分是LSTM网络，它是RNN网络的衍生，旨在避免长序列训练过程中的梯度消失和梯度爆炸。
本毕设中使用的模型由编码器和解码器组成，每个编码器和解码器都是LSTM。信息被选择性地通过门控机制以增强其时间依赖性。(图4.1)显示了LSTM-AE模型的体系结构。在编码器阶段，时间t的隐藏状态Ht,其中i-4<t≤i,受到当前时间的输入向量和前一时间的隐藏状态的影响。然后，时间i处的隐式状态被传递到解码器，其中的过程与编码器中的过程正好相反。解码器从时间i逐渐遍历到时间i-4。因此，时间t(i-4≤t<i)的隐藏状态H将受到隐含状态和随后时间的重构向量的影响。
Xi4Xi-3Xi2Xi-1X输出门记忆单元H₁4← H₁-s'< Hi-2< H-1←H的入门解码器编码器Hi-3Hi-2H-1H₁输出门H₁-4才记忆单元Xi4Xi-3XXi2输入门Xi₁
遗忘门
遗忘门
图4.1输入序列数据长度为5的LSTM-AE。
4.2基于LSTM-AE的异常检测
总的来说，如(图4.2)所示，基于LSTM-AE模型的PV序列数据异常检测主要分为三个步骤，如下所示：
step1.变量特征重要性计算并排列，将排名前三的变量(共五个变量)指定用于建模，即环境温度、模块温度和辐照度。
step2.所选变量与发电量相结合，作为我们模型输入的数据。然后，训练基于LSTM的编码器来提取低维特征表示，即潜在向量H,以表征每个输入序列的进展。潜在向量H被馈送到AE模型的解码器中进行序列重建，从而恢复输入序列中每个因子的期望值。
10序列重建得到的发电量与真实发电量进行比较来计算偏差。如果偏差超出固
定阈值，则定义为会发出异常事件。


第三个样例：
浙江财经大学本科生毕业论文
4碳排放特征提取
本文提出的碳排放特征提取模型由基于层次分析的地理空间加权网络和地理空间加权网络的特征提取两部分组成。本节将介绍各部分的主要技术和理论。
4.1基于层次分析的地理空间加权网络
本研究采用的碳排放数据包括石油、天然气、原煤三种能源和一种与建筑材料相关的碳排放。每种能源都包含多种类型的碳排放源。不同省份的能源类型及其内部碳排放源的层次关系影响着碳排放总量。为了减少相邻省份碳排放聚集效应的差异，计算需要考虑能源类型和碳排放源，采用解析层次过程(AHP)计算了两层数据对碳排放的总影响。AHP方法将问题划分不同的部分，通过计算每个部分对总体的影响因子，加权求和得到总体的影响系数。层次分析方法的步骤如下：
(1)成对比较矩阵的构建
在本文中，C={C1,…,Cn}表达因子，并采用两两比较法计算因子对总值G的影响。结果由矩阵表达，A=(azj)(nxn)(aij>0)如下：
(4-1)
aji=其中a;j表示C₂和C;对G的影响的比值.azj=1(i=j),。因此，A是一个n阶的正倒数矩阵。
(2)成对一致性矩阵的构建
成对比较矩阵中每行元素的一致性矩阵A=aij(nxn),与n一致性矩阵RK)(k=1,2,….,n)。根据kh构造一致性矩阵的对比矩阵A如下：
=( -(4-2)
7浙江财经大学本科生毕业论文
采用方根法求解唯一单位向量W(k)对应于最大影响的权重R(k):W(k)=(w₁(k),w₂k),…,wn(k))。
(3)各因子的影响系数可表示为如下：
w= )(4-3)
因此，mth省的碳排放影响可表示为如下：
c-2(4-4)
两个省之间的碳排放量差异可以由如下方法计算：
ek=|G₂-Gli≠j(4-5)
每个省份可以被表示成地理空间加权网络中的节点，各个省份组成一个网络节点集V={v1,U₂,…,vn},每个节点存储省份名称，地理位置，碳排放影响系数。相邻省份的碳排放差异可以被表示为网络边的权重E={e1,e2,…,em}。最后，基于相邻省份的碳排放差异数据，可以构建一个地理空间加权网络G(V,E),是一个无向加权网络，其中节点表示省份，两个节点之间的边表示两个省份之间的碳排放差异，差异越大，边的权重越大。
4.2地理空间加权网络的特征提取
Louvain是一种基于模块度的社区检测算法，它可以将大规模网络快速划分为不同粒度的社区，而不需要指定社区的数目。本文利用Louvain算法识别相邻省份的碳排放网络结构，提取空间特征。Louvain是一种基于贪心策略的模块度最优算法，社区划分的好坏由模块度的大小决定，当社区中的模块度不再增加时，算法达到收敛。其中模块度的计算方法如下：△e=[Cm+ki-C+](4-6)-[--m²-(
其中Cin表示社区C中边的权重之和，Ctot是社区C中相邻节点的边权重之和，k;是指向节点i的所有相邻边的权值之和，k(in)是节点i和所有节点相邻的边权值之和，m是地理空间加权网络中所有边的权值之和。Louvain模型的构建主要包括以下三个步骤：
步骤1.将G中的每个节点初始化为一个独立的社区，对社区进行唯一的编码标识。此时，社区的数量等于节点的数量。
8步骤 2. 对每个节点 vi 做以下操作：
1. 识别将该节点划分为其邻居节点 vj 的社区，并计算网络的模块度变化 ∆Q。
2. 如果 ∆Q > 0，即模块度有增益，则添加 vi 到 vj 所在的社区；否则，不进行这一
步。继续对其余节点进行社区合并的操作。
步骤 3. 重复步骤 2 直至 ∆Q 不再增大，算法达到收敛，社区划分结束。