<!-- templates/users/user_profile.html -->
{% extends "users/base.html" %}

{% block title %}编辑个人资料{% endblock %}

{% block project_nav %}
<ul class="nav" style="position: fixed;width: 13.5%;">
    <!-- 主界面 -->
    <li class="nav-item">
        <a class="nav-link" href="{% url 'home' %}">
            <i class="mdi mdi-grid-large menu-icon"></i>
            <span class="menu-title">Main interface</span>
        </a>
    </li>

    <!-- 个人项目 -->
    <li class="nav-item">
        <a class="nav-link" href="{% url 'personal_projects' %}">
            <i class="mdi mdi-folder-multiple menu-icon"></i>
            <span class="menu-title">Personal project</span>
        </a>
    </li>

    <!-- 项目功能分组 -->
    <li class="nav-item nav-category">项目功能</li>

    <!-- 训练仪表盘 -->
    <li class="nav-item">
        {% if project %}
        <a class="nav-link" href="{% url 'data_training_dash' project.id %}">
            <i class="fa fa-desktop menu-icon"></i>
            <span class="menu-title">Training Dashboard</span>
        </a>
        {% else %}
        <a class="nav-link disabled" href="#" onclick="alert('Please create a project first!'); return false;">
            <i class="fa fa-desktop menu-icon"></i>
            <span class="menu-title">Training Dashboard</span>
        </a>
        {% endif %}
    </li>

    <!-- 数据预测 -->
    <li class="nav-item">
        {% if project %}
        <a class="nav-link" href="{% url 'data_prediction' project.id %}">
            <i class="mdi mdi-chart-bar menu-icon"></i>
            <span class="menu-title">Data prediction</span>
        </a>
        {% else %}
        <a class="nav-link disabled" href="#" onclick="alert('Please create a project first!'); return false;">
            <i class="mdi mdi-chart-bar menu-icon"></i>
            <span class="menu-title">Data prediction</span>
        </a>
        {% endif %}
    </li>

    <!-- 存储管理分组 -->
    <li class="nav-item">
        {% if project %}
        <a class="nav-link" data-bs-toggle="collapse" href="#storage-management" aria-expanded="false" aria-controls="storage-management">
            <i class="menu-icon mdi mdi-database"></i>
            <span class="menu-title">Storage Management</span>
            <i class="menu-arrow"></i>
        </a>
        <div class="collapse" id="storage-management">
            <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="{% url 'manage_data' project.id %}">Data Management</a></li>
                <li class="nav-item"> <a class="nav-link" href="{% url 'model_management' project.id %}">Model Management</a></li>
            </ul>
        </div>
        {% else %}
        <a class="nav-link disabled" href="#" onclick="alert('Please create a project first!'); return false;">
            <i class="menu-icon mdi mdi-database"></i>
            <span class="menu-title">Storage Management</span>
        </a>
        {% endif %}
    </li>
</ul>
{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-12">
        <div class="card">
            <div class="card-body text-center">
                <h4 class="card-title">Edit Profile</h4>
                <form method="post">
                    {% csrf_token %}
                    <div class="form-group d-flex justify-content-center">
                        <label for="id_nickname" class="mr-2">Nickname:</label>
                        <input type="text" class="form-control form-control-short" id="id_nickname" name="nickname" value="{{ user.nickname }}">
                    </div>
                    <div class="form-group d-flex justify-content-center">
                        <label for="id_gender" class="mr-2">Gender:</label>
                        <select class="form-control form-control-short" id="id_gender" name="gender">
                            <option value="" {% if not user.gender %}selected{% endif %}>Select Gender</option>
                            <option value="M" {% if user.gender == 'M' %}selected{% endif %}>Male</option>
                            <option value="F" {% if user.gender == 'F' %}selected{% endif %}>Female</option>
                        </select>
                    </div>
                    <div class="form-group d-flex justify-content-center">
                        <label for="id_age" class="mr-2">Age:</label>
                        <input type="number" class="form-control form-control-short" id="id_age" name="age" value="{{ user.age }}">
                    </div>
                    <div class="form-group d-flex justify-content-center">
                        <label for="id_coding_experience" class="mr-2">Coding Experience (Years):</label>
                        <input type="number" class="form-control form-control-short" id="id_coding_experience" name="coding_experience" value="{{ user.coding_experience }}">
                    </div>
                    <div class="form-group d-flex justify-content-center">
                        <label for="id_bio" class="mr-2">Bio:</label>
                        <textarea class="form-control" id="id_bio" name="bio">{{ user.bio }}</textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}